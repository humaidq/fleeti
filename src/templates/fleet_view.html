{{ template "head" . }}

{{ if .Breadcrumbs }}
<nav class="breadcrumb" aria-label="Breadcrumb">
  {{ range $i, $b := .Breadcrumbs }}
    {{ if $i }}<span class="breadcrumb-separator">&gt;</span>{{ end }}
    {{ if $b.IsCurrent }}
      <span class="breadcrumb-current">{{ $b.Name }}</span>
    {{ else }}
      <a href="{{ $b.URL }}" class="breadcrumb-item">{{ $b.Name }}</a>
    {{ end }}
  {{ end }}
</nav>
{{ end }}

<div class="page-header">
  <h2>Fleet Summary</h2>
  <div class="page-header-actions">
    {{ if .CanManageFleet }}
    <a href="/fleets/{{ .Fleet.ID }}/access" class="btn">Access</a>
    {{ end }}
    <a href="/fleets" class="btn">Back to Fleets</a>
  </div>
</div>

<section class="section-card">
  <h3>{{ .Fleet.Name }}</h3>
  <p class="muted-text">Created (UTC): {{ .Fleet.CreatedAt }}</p>
  {{ if .Fleet.Description }}
  <p>{{ .Fleet.Description }}</p>
  {{ else }}
  <p class="muted-text">No description provided.</p>
  {{ end }}
  {{ template "fleet_nav" . }}
</section>

{{ if .CanManageFleet }}
<section class="section-card" id="fleet-edit">
  <h3>Edit</h3>
  <form method="post" action="/fleets/{{ .Fleet.ID }}/edit">
    <input type="hidden" name="_csrf" value="{{ .csrf_token }}" />
    <div class="form-group">
      <label for="fleet-name">Name</label>
      <input id="fleet-name" name="name" class="form-item" value="{{ .Fleet.Name }}" required />
    </div>
    <div class="form-group">
      <label for="fleet-description">Description</label>
      <textarea id="fleet-description" name="description" class="form-item" rows="3">{{ .Fleet.Description }}</textarea>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn">Save Edit</button>
    </div>
  </form>
</section>
{{ end }}

{{ if .CanManageFleet }}
<section class="section-card">
  <h3>Delete</h3>
  <p class="muted-text">Permanently delete this fleet and all associated data.</p>
  <form method="post" action="/fleets/{{ .Fleet.ID }}/delete" class="inline-form" onsubmit="return confirm('Permanently delete this fleet and all associated data? This cannot be undone.');">
    <input type="hidden" name="_csrf" value="{{ .csrf_token }}" />
    <button type="submit" class="btn btn-danger">Delete Permanently</button>
  </form>
</section>
{{ end }}

{{ template "foot" . }}
